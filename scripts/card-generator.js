const axios = require('axios');
const fs = require('fs');

//const url =Â 'https://raw.githubusercontent.com/the-fab-cube/flesh-and-blood-cards/rosetta/json/english/card.json'; //ROS
const url = "https://raw.githubusercontent.com/the-fab-cube/flesh-and-blood-cards/refs/heads/the-hunters/json/english/card.json"; //!HNT


const outputFile = 'src/constants/cardList.ts';

axios
  .get(url)
  .then((jsonString) => {
    const cards = jsonString.data;

    const cardNames = cards.reduce((acc, card) => {
      const name = card.name;

      if (card.types.includes('Token')) {
        return acc;
      }

      // if name has "//" split into two names
      if (name.includes("//")) {
        const [name1, name2] = name.split("//");
        if (acc.includes(name1.trim()) || acc.includes(name2.trim())) {
          return acc;
        }
        return acc.concat(name1.trim(), name2.trim());
      }

      if (!acc.includes(name)) {
        acc.push(name);
      }

      return acc;
    }, []);

    const sortedCardNames = cardNames.sort();

    const exportData = `// This file is generated by the card-generator script. Do not edit it manually. \nexport const CARD_LIST: string[] = ${JSON.stringify(
      sortedCardNames,
      null,
      2
    )};`;

    fs.mkdirSync('../src/constants', { recursive: true }); // create the constants directory if it doesn't exist
    fs.writeFileSync(outputFile, exportData);
  })
  .catch((err) => {
    console.error(err);
  });
